<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NEXUS-7 Â· MD5 </title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Share+Tech+Mono&display=swap" rel="stylesheet">
<style>
:root {
  --c: #00f5ff;       /* cyan primary */
  --c2: #0af;
  --g: #00ff88;       /* green accent */
  --r: #ff3355;       /* red/danger */
  --y: #ffcc00;       /* yellow warning */
  --bg: #020c14;
  --bg2: #041a28;
  --panel: rgba(0,245,255,0.04);
  --border: rgba(0,245,255,0.18);
  --text: rgba(0,245,255,0.85);
  --dim: rgba(0,245,255,0.35);
}
*{margin:0;padding:0;box-sizing:border-box;}

html{scroll-behavior:smooth;}

body {
  background: var(--bg);
  color: var(--text);
  font-family: 'Share Tech Mono', monospace;
  min-height: 100vh;
  overflow-x: hidden;
  cursor: crosshair;
}

/* â”€â”€ GRID BG â”€â”€ */
body::before {
  content:'';
  position:fixed;inset:0;
  background-image:
    linear-gradient(rgba(0,245,255,0.04) 1px, transparent 1px),
    linear-gradient(90deg, rgba(0,245,255,0.04) 1px, transparent 1px);
  background-size: 40px 40px;
  pointer-events:none;z-index:0;
}

body::after {
  content:'';
  position:fixed;inset:0;
  background: radial-gradient(ellipse at 50% 0%, rgba(0,100,160,0.25) 0%, transparent 65%),
              radial-gradient(ellipse at 80% 100%, rgba(0,245,255,0.06) 0%, transparent 50%);
  pointer-events:none;z-index:0;
}

/* â”€â”€ SCANLINE â”€â”€ */
.scanline {
  position:fixed;top:0;left:0;right:0;
  height:3px;
  background:linear-gradient(to bottom,transparent,rgba(0,245,255,0.15),transparent);
  animation:scan 6s linear infinite;
  z-index:5;pointer-events:none;
}
@keyframes scan{from{top:-3px}to{top:100vh}}

/* â”€â”€ PARTICLES â”€â”€ */
.particles{position:fixed;inset:0;pointer-events:none;z-index:1;overflow:hidden;}
.p{position:absolute;width:2px;height:2px;background:var(--c);border-radius:50%;
   animation:float linear infinite;opacity:0;}
@keyframes float{
  0%{transform:translateY(100vh) translateX(0);opacity:0;}
  10%{opacity:.6;}
  90%{opacity:.2;}
  100%{transform:translateY(-20px) translateX(var(--dx));opacity:0;}
}

/* â”€â”€ LAYOUT â”€â”€ */
.shell{max-width:560px;margin:0 auto;padding:20px 16px 80px;position:relative;z-index:2;}

/* â”€â”€ HEADER â”€â”€ */
header{text-align:center;padding:28px 0 20px;position:relative;}
.hdr-corner{
  position:absolute;width:18px;height:18px;
  border-color:var(--c);border-style:solid;
  opacity:.6;
}
.hdr-corner.tl{top:16px;left:0;border-width:2px 0 0 2px;}
.hdr-corner.tr{top:16px;right:0;border-width:2px 2px 0 0;}
.hdr-corner.bl{bottom:0;left:0;border-width:0 0 2px 2px;}
.hdr-corner.br{bottom:0;right:0;border-width:0 2px 2px 0;}

.sys-id{font-size:.6rem;letter-spacing:6px;color:var(--dim);margin-bottom:6px;
  animation:blink 4s step-start infinite;}
@keyframes blink{0%,100%{opacity:.35}50%{opacity:.8}}

.logo{
  font-family:'Orbitron',monospace;font-weight:900;
  font-size:2rem;letter-spacing:6px;
  background:linear-gradient(135deg,var(--c),var(--g),var(--c));
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;
  text-shadow:none;filter:drop-shadow(0 0 16px rgba(0,245,255,0.5));
}
.logo-sub{font-size:.62rem;letter-spacing:8px;color:var(--dim);margin-top:4px;}

.status-bar{
  display:flex;align-items:center;justify-content:center;gap:10px;
  margin-top:12px;font-size:.58rem;letter-spacing:3px;color:var(--dim);
}
.status-dot{width:6px;height:6px;border-radius:50%;background:var(--g);
  box-shadow:0 0 8px var(--g);animation:pulse 2s ease-in-out infinite;}
@keyframes pulse{0%,100%{opacity:1;transform:scale(1)}50%{opacity:.4;transform:scale(.7)}}

/* â”€â”€ PANEL â”€â”€ */
.panel{
  background:var(--panel);
  border:1px solid var(--border);
  border-radius:4px;
  padding:16px;
  margin-bottom:14px;
  position:relative;
  backdrop-filter:blur(8px);
}
.panel::before{
  content:'';position:absolute;top:0;left:0;right:0;height:1px;
  background:linear-gradient(to right,transparent,var(--c),transparent);
  opacity:.4;
}

.panel-hdr{
  font-family:'Orbitron',monospace;
  font-size:.58rem;letter-spacing:4px;color:var(--dim);
  margin-bottom:12px;display:flex;align-items:center;gap:8px;
}
.panel-hdr::before{content:'â–¶';font-size:.5rem;color:var(--c);}

/* â”€â”€ INPUT â”€â”€ */
.input-wrap{position:relative;}
.md5-input{
  width:100%;
  background:rgba(0,0,0,0.5);
  border:1px solid var(--border);
  border-radius:3px;
  color:var(--c);
  font-family:'Share Tech Mono',monospace;
  font-size:.78rem;
  padding:11px 44px 11px 12px;
  outline:none;
  letter-spacing:1.5px;
  transition:border-color .2s,box-shadow .2s;
  caret-color:var(--g);
}
.md5-input:focus{
  border-color:var(--c);
  box-shadow:0 0 0 2px rgba(0,245,255,0.08),0 0 20px rgba(0,245,255,0.1);
}
.md5-input::placeholder{color:rgba(0,245,255,0.2);}
.input-len{
  position:absolute;right:10px;top:50%;transform:translateY(-50%);
  font-size:.58rem;color:var(--dim);
}
.input-status{
  font-size:.6rem;margin-top:5px;letter-spacing:1px;
  transition:color .2s;
}

/* â”€â”€ ANALYZE BUTTON â”€â”€ */
.btn-analyze{
  width:100%;padding:13px;
  background:transparent;
  border:1.5px solid var(--c);
  border-radius:3px;
  color:var(--c);
  font-family:'Orbitron',monospace;
  font-size:.8rem;letter-spacing:5px;
  cursor:pointer;
  position:relative;overflow:hidden;
  transition:all .25s;
  margin-bottom:14px;
  box-shadow:0 0 20px rgba(0,245,255,0.08),inset 0 0 20px rgba(0,245,255,0.03);
}
.btn-analyze::before{
  content:'';position:absolute;inset:0;
  background:linear-gradient(135deg,transparent,rgba(0,245,255,0.08),transparent);
  transform:translateX(-100%);transition:transform .4s;
}
.btn-analyze:hover{
  background:rgba(0,245,255,0.07);
  box-shadow:0 0 30px rgba(0,245,255,0.2),inset 0 0 20px rgba(0,245,255,0.05);
  color:#fff;text-shadow:0 0 10px var(--c);
}
.btn-analyze:hover::before{transform:translateX(100%);}
.btn-analyze:active{transform:scale(.98);}
.btn-analyze:disabled{opacity:.4;cursor:not-allowed;}

/* â”€â”€ RESULT AREA â”€â”€ */
.result-area{display:none;}
.result-area.show{display:block;animation:fadeUp .4s ease forwards;}
@keyframes fadeUp{from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}

/* â”€â”€ ANALYZING ANIMATION â”€â”€ */
.analyzing{
  display:none;text-align:center;padding:30px 0;
}
.analyzing.show{display:block;}
.ana-txt{
  font-family:'Orbitron',monospace;font-size:.7rem;letter-spacing:4px;color:var(--c);
}
.ana-bar-wrap{
  width:80%;height:3px;background:rgba(0,245,255,0.1);
  border-radius:2px;margin:14px auto;overflow:hidden;
}
.ana-bar{
  height:100%;background:linear-gradient(to right,var(--c),var(--g));
  border-radius:2px;width:0%;transition:width .1s linear;
}
.ana-steps{font-size:.58rem;color:var(--dim);min-height:16px;letter-spacing:1px;}

/* â”€â”€ VERDICT â”€â”€ */
.verdict-panel{
  padding:20px;text-align:center;border-radius:4px;
  margin-bottom:14px;position:relative;overflow:hidden;
  border:1.5px solid;
}
.verdict-panel.tai{
  border-color:rgba(255,51,85,0.6);
  background:linear-gradient(135deg,rgba(255,30,60,0.08),rgba(180,0,30,0.12));
  box-shadow:0 0 30px rgba(255,51,85,0.12);
}
.verdict-panel.xiu{
  border-color:rgba(0,245,255,0.5);
  background:linear-gradient(135deg,rgba(0,245,255,0.05),rgba(0,150,200,0.08));
  box-shadow:0 0 30px rgba(0,245,255,0.1);
}
.verdict-panel::before{
  content:'';position:absolute;top:0;left:0;right:0;height:1px;
}
.tai::before{background:linear-gradient(to right,transparent,rgba(255,51,85,0.8),transparent);}
.xiu::before{background:linear-gradient(to right,transparent,rgba(0,245,255,0.8),transparent);}

.verdict-label{
  font-family:'Orbitron',monospace;font-size:2.4rem;font-weight:900;
  letter-spacing:8px;
  animation:glitch .1s ease-in-out;
}
.tai .verdict-label{color:#ff3355;text-shadow:0 0 30px rgba(255,51,85,0.7),0 0 60px rgba(255,51,85,0.3);}
.xiu .verdict-label{color:#00f5ff;text-shadow:0 0 30px rgba(0,245,255,0.7),0 0 60px rgba(0,245,255,0.3);}

@keyframes glitch{
  0%{transform:translate(0)}10%{transform:translate(-2px,1px)}
  20%{transform:translate(2px,-1px)}30%{transform:translate(-1px,0)}
  40%{transform:translate(1px,1px)}50%{transform:translate(0)}100%{transform:translate(0)}
}

.verdict-type{font-size:.58rem;letter-spacing:5px;color:var(--dim);margin-top:4px;}

/* â”€â”€ CONFIDENCE GAUGE â”€â”€ */
.conf-section{margin-top:14px;}
.conf-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px;}
.conf-label{font-size:.6rem;letter-spacing:3px;color:var(--dim);}
.conf-pct{
  font-family:'Orbitron',monospace;font-size:1.1rem;font-weight:700;
}
.tai .conf-pct{color:#ff3355;text-shadow:0 0 10px rgba(255,51,85,0.5);}
.xiu .conf-pct{color:var(--c);text-shadow:0 0 10px rgba(0,245,255,0.5);}

.conf-track{
  height:8px;background:rgba(0,0,0,0.5);border-radius:4px;
  border:1px solid rgba(0,245,255,0.1);overflow:hidden;position:relative;
}
.conf-fill{
  height:100%;border-radius:4px;width:0%;
  transition:width 1s cubic-bezier(.4,0,.2,1);
  position:relative;overflow:hidden;
}
.tai .conf-fill{background:linear-gradient(to right,#ff3355,#ff7755);}
.xiu .conf-fill{background:linear-gradient(to right,#0088cc,#00f5ff);}
.conf-fill::after{
  content:'';position:absolute;inset:0;
  background:linear-gradient(to right,transparent,rgba(255,255,255,0.2),transparent);
  animation:shimmer 2s linear infinite;
}
@keyframes shimmer{from{transform:translateX(-100%)}to{transform:translateX(100%)}}

/* â”€â”€ WARNING BADGE â”€â”€ */
.warn-badge{
  display:flex;align-items:center;gap:10px;
  padding:10px 14px;border-radius:3px;margin-top:12px;
  font-size:.65rem;letter-spacing:1.5px;line-height:1.5;
}
.warn-badge.light{
  background:rgba(255,204,0,0.07);border:1px solid rgba(255,204,0,0.3);
  color:#ffcc00;
}
.warn-badge.strong{
  background:rgba(0,255,136,0.07);border:1px solid rgba(0,255,136,0.4);
  color:#00ff88;
  animation:strongPulse 2s ease-in-out infinite;
}
.warn-badge.caution{
  background:rgba(255,100,0,0.07);border:1px solid rgba(255,120,0,0.35);
  color:#ff8833;
}
@keyframes strongPulse{0%,100%{box-shadow:0 0 0 rgba(0,255,136,0)}50%{box-shadow:0 0 12px rgba(0,255,136,0.2)}}
.warn-icon{font-size:1.1rem;flex-shrink:0;}
.warn-txt b{font-weight:700;}

/* â”€â”€ STATS GRID â”€â”€ */
.stats-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:14px;}
.stat-card{
  background:var(--panel);border:1px solid var(--border);
  border-radius:4px;padding:12px;text-align:center;
}
.stat-val{
  font-family:'Orbitron',monospace;font-size:1.2rem;font-weight:700;color:var(--c);
  text-shadow:0 0 10px rgba(0,245,255,0.4);
}
.stat-lbl{font-size:.55rem;letter-spacing:3px;color:var(--dim);margin-top:3px;}

/* â”€â”€ HEX BREAKDOWN â”€â”€ */
.hex-grid{
  display:grid;grid-template-columns:repeat(8,1fr);gap:4px;margin-bottom:10px;
}
.hex-seg{
  text-align:center;padding:5px 2px;border-radius:2px;
  font-size:.55rem;letter-spacing:.5px;
  transition:all .3s;
}
.hex-seg .sv{color:var(--c);font-size:.62rem;}
.hex-seg .sv2{font-size:.5rem;color:var(--dim);margin-top:2px;}
.hex-seg .si{font-size:.55rem;font-weight:700;margin-top:3px;}
.hex-seg.t{background:rgba(255,51,85,0.1);border:1px solid rgba(255,51,85,0.3);}
.hex-seg.t .si{color:#ff3355;}
.hex-seg.x{background:rgba(0,245,255,0.06);border:1px solid rgba(0,245,255,0.2);}
.hex-seg.x .si{color:var(--c);}

/* â”€â”€ PROBABILITY BAR â”€â”€ */
.prob-bar-wrap{margin-bottom:14px;}
.prob-labels{display:flex;justify-content:space-between;font-size:.58rem;color:var(--dim);margin-bottom:5px;}
.prob-track{
  height:14px;border-radius:2px;overflow:hidden;display:flex;
  border:1px solid rgba(0,245,255,0.1);
}
.prob-xiu{
  background:linear-gradient(to right,#0044aa,#0088cc);
  transition:width 1s cubic-bezier(.4,0,.2,1);
  display:flex;align-items:center;justify-content:flex-end;padding-right:4px;
}
.prob-tai{
  background:linear-gradient(to left,#aa0022,#ff3355);
  transition:width 1s cubic-bezier(.4,0,.2,1);
  display:flex;align-items:center;padding-left:4px;
}
.prob-pct{font-size:.52rem;color:rgba(255,255,255,0.8);}

/* â”€â”€ ANALYSIS LOG â”€â”€ */
.log-wrap{
  max-height:160px;overflow-y:auto;
  font-size:.6rem;line-height:1.8;color:rgba(0,245,255,0.6);
  scrollbar-width:thin;scrollbar-color:rgba(0,245,255,0.2) transparent;
}
.log-line{display:flex;gap:8px;}
.log-time{color:var(--dim);flex-shrink:0;}
.log-msg b{color:var(--c);}
.log-msg .hi-t{color:#ff5566;}
.log-msg .hi-x{color:#22ccff;}
.log-msg .hi-g{color:var(--g);}

/* â”€â”€ BYTE MAP â”€â”€ */
.byte-map{
  display:flex;flex-wrap:wrap;gap:3px;margin-top:6px;
}
.byte-cell{
  width:20px;height:14px;border-radius:1px;
  font-size:.42rem;display:flex;align-items:center;justify-content:center;
  color:rgba(0,0,0,0.7);font-weight:700;
}

/* scrollbar */
.log-wrap::-webkit-scrollbar{width:3px;}
.log-wrap::-webkit-scrollbar-track{background:transparent;}
.log-wrap::-webkit-scrollbar-thumb{background:rgba(0,245,255,0.2);border-radius:2px;}

/* corner decorations on panels */
.panel .c-tl,.panel .c-br{
  position:absolute;width:8px;height:8px;
  border-color:var(--c);border-style:solid;opacity:.4;
}
.panel .c-tl{top:4px;left:4px;border-width:1px 0 0 1px;}
.panel .c-br{bottom:4px;right:4px;border-width:0 1px 1px 0;}
</style>
</head>
<body>

<div class="scanline"></div>

<!-- particles -->
<div class="particles" id="particles"></div>

<div class="shell">

  <!-- HEADER -->
  <header>
    <div class="hdr-corner tl"></div>
    <div class="hdr-corner tr"></div>
    <div class="hdr-corner bl"></div>
    <div class="hdr-corner br"></div>
    <div class="sys-id">SYS-ID: NEXUS-7 Â· UNIT-âˆ†09 Â· ONLINE</div>
    <div class="logo">NEXUS-7</div>
    <div class="logo-sub">MD5 QUANTUM ENGINE</div>
    <div class="status-bar">
      <span class="status-dot"></span>
      <span>CORE ACTIVE</span>
      <span style="color:rgba(0,245,255,0.15)">|</span>
      <span>MD5 v4.1</span>
    </div>
  </header>

  <!-- INPUT PANEL -->
  <div class="panel">
    <div class="c-tl"></div><div class="c-br"></div>
    <div class="panel-hdr">NHáº¬P MÃƒ MD5 Äá»‚ PHÃ‚N TÃCH</div>
    <div class="input-wrap">
      <input id="md5In" class="md5-input" maxlength="32"
        placeholder="a3f2c1d4e5b6f7a8b9c0d1e2f3a4b5c6"
        autocomplete="off" spellcheck="false" oninput="onInput()"/>
      <span class="input-len" id="lenDisp">0/32</span>
    </div>
    <div class="input-status" id="inputStatus" style="color:var(--dim)">
      &gt;_ AWAITING INPUT...
    </div>
  </div>

  <!-- ANALYZE BUTTON -->
  <button class="btn-analyze" id="btnAnalyze" onclick="analyze()" disabled>
    â—ˆ KHá»I Äá»˜NG PHÃ‚N TÃCH â—ˆ
  </button>

  <!-- ANALYZING ANIMATION -->
  <div class="analyzing" id="analyzingDiv">
    <div class="ana-txt" id="anaTxt">INITIALIZING...</div>
    <div class="ana-bar-wrap"><div class="ana-bar" id="anaBar"></div></div>
    <div class="ana-steps" id="anaSteps"></div>
  </div>

  <!-- RESULT AREA -->
  <div class="result-area" id="resultArea">

    <!-- VERDICT -->
    <div class="verdict-panel" id="verdictPanel">
      <div class="verdict-label" id="verdictLabel"></div>
      <div class="verdict-type" id="verdictType"></div>
      <div class="conf-section">
        <div class="conf-header">
          <span class="conf-label">Äá»˜ TIN Cáº¬Y Há»† THá»NG</span>
          <span class="conf-pct" id="confPct"></span>
        </div>
        <div class="conf-track"><div class="conf-fill" id="confFill"></div></div>
      </div>
      <div class="warn-badge" id="warnBadge">
        <span class="warn-icon" id="warnIcon"></span>
        <span class="warn-txt" id="warnTxt"></span>
      </div>
    </div>

    <!-- STATS -->
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-val" id="statTai"></div>
        <div class="stat-lbl">XÃC SUáº¤T TÃ€I</div>
      </div>
      <div class="stat-card">
        <div class="stat-val" id="statXiu"></div>
        <div class="stat-lbl">XÃC SUáº¤T Xá»ˆU</div>
      </div>
      <div class="stat-card">
        <div class="stat-val" id="statEntropy"></div>
        <div class="stat-lbl">ENTROPY INDEX</div>
      </div>
      <div class="stat-card">
        <div class="stat-val" id="statBias"></div>
        <div class="stat-lbl">BIAS SCORE</div>
      </div>
    </div>

    <!-- PROBABILITY BAR -->
    <div class="panel">
      <div class="c-tl"></div><div class="c-br"></div>
      <div class="panel-hdr">PHÃ‚N Bá» XÃC SUáº¤T</div>
      <div class="prob-bar-wrap">
        <div class="prob-labels">
          <span id="lblXiu">Xá»ˆU</span>
          <span id="lblTai">TÃ€I</span>
        </div>
        <div class="prob-track">
          <div class="prob-xiu" id="probXiu"><span class="prob-pct" id="pctXiu"></span></div>
          <div class="prob-tai" id="probTai"><span class="prob-pct" id="pctTai"></span></div>
        </div>
      </div>
    </div>

    <!-- HEX BREAKDOWN -->
    <div class="panel">
      <div class="c-tl"></div><div class="c-br"></div>
      <div class="panel-hdr">PHÃ‚N TÃCH 8 PHÃ‚N ÄOáº N HEX</div>
      <div class="hex-grid" id="hexGrid"></div>
      <!-- Byte heat map -->
      <div class="panel-hdr" style="margin-top:12px">BYTE ENTROPY MAP</div>
      <div class="byte-map" id="byteMap"></div>
    </div>

    <!-- ANALYSIS LOG -->
    <div class="panel">
      <div class="c-tl"></div><div class="c-br"></div>
      <div class="panel-hdr">NHáº¬T KÃ PHÃ‚N TÃCH Há»† THá»NG</div>
      <div class="log-wrap" id="logWrap"></div>
    </div>

  </div><!-- /result-area -->

</div><!-- /shell -->

<script>
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// PARTICLES
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
(function(){
  const cont = document.getElementById('particles');
  for(let i=0;i<28;i++){
    const p=document.createElement('div'); p.className='p';
    const x = Math.random()*100;
    const dur = 8+Math.random()*14;
    const dx = (Math.random()-0.5)*120+'px';
    p.style.cssText=`left:${x}%;animation-duration:${dur}s;animation-delay:${Math.random()*dur}s;--dx:${dx};`;
    cont.appendChild(p);
  }
})();

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// INPUT HANDLING
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const hexRe = /^[0-9a-fA-F]{32}$/;

function onInput(){
  const v=document.getElementById('md5In').value.trim();
  document.getElementById('lenDisp').textContent=v.length+'/32';
  const btn=document.getElementById('btnAnalyze');
  const st=document.getElementById('inputStatus');
  if(!v){st.style.color='var(--dim)';st.textContent='>_ AWAITING INPUT...';btn.disabled=true;return;}
  if(!hexRe.test(v)){
    st.style.color='var(--r)';
    st.textContent=`>_ ERR: ${v.length<32?'INSUFFICIENT DATA ('+v.length+'/32)':'INVALID CHARACTERS DETECTED'}`;
    btn.disabled=true;
  } else {
    st.style.color='var(--g)';
    st.textContent='>_ VALID MD5 HASH â€” READY FOR ANALYSIS';
    btn.disabled=false;
  }
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// CORE ANALYSIS ENGINE
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

/* 
  ALGORITHM â€” Multi-layer MD5 decomposition:

  Layer 1 â€“ Segment voting (8 Ã— 4-hex segments)
    - Even/odd parity of decimal value: oddâ†’TÃ i bias, evenâ†’Xá»‰u bias
    - High/low half of 16-bit range: â‰¥32768â†’TÃ i, <32768â†’Xá»‰u
    - Exponential position weights: front segments carry more signal

  Layer 2 â€“ Byte-level entropy analysis (16 bytes)
    - Shannon-style entropy: high entropyâ†’more decisive signal
    - Mean byte value vs 127.5 midpoint â†’ systematic T/X lean
    - XOR accumulator â†’ residual bias detection

  Layer 3 â€“ Hexadecimal pattern analysis
    - Count of hex digits a-f vs 0-9 (letters tend toward higher values)
    - Run-length detection of consecutive same-parity nibbles

  Layer 4 â€“ Composite scoring
    - Weighted combination of all layers
    - Sigmoid normalization to get probability
    - Confidence derived from deviation from 50% baseline
*/

function analyzeMD5(md5){
  md5 = md5.toLowerCase();

  // â”€ Layer 1: Segment voting â”€
  const segs=[];
  const weights=[.22,.18,.15,.12,.10,.09,.08,.06];
  let l1Score=0;
  for(let i=0;i<8;i++){
    const h=md5.slice(i*4,i*4+4);
    const d=parseInt(h,16);
    const parity=d%2; // 1=oddâ†’T
    const half=d>=32768?1:0; // 1=highâ†’T
    const segVote=(parity+half)/2; // 0..1 probability T
    segs.push({h,d,segVote,parity,half});
    l1Score+=segVote*weights[i];
  }

  // â”€ Layer 2: Byte entropy â”€
  const bytes=[];
  for(let i=0;i<32;i+=2) bytes.push(parseInt(md5.slice(i,i+2),16));
  const mean=bytes.reduce((a,b)=>a+b,0)/16;
  const meanBias=(mean-127.5)/127.5; // -1..+1, positiveâ†’T
  let xorAcc=0; bytes.forEach(b=>xorAcc^=b);
  const xorBias=(xorAcc-127.5)/127.5;
  // variance â†’ entropy proxy
  const variance=bytes.reduce((a,b)=>a+(b-mean)**2,0)/16;
  const normVar=Math.min(1,variance/4096); // 0..1
  const l2Score=0.5 + (meanBias*0.35 + xorBias*0.15)*0.5;

  // â”€ Layer 3: Pattern analysis â”€
  const letters=(md5.match(/[a-f]/g)||[]).length;
  const digits=(md5.match(/[0-9]/g)||[]).length;
  const letterBias=(letters-digits)/32; // positiveâ†’higher valuesâ†’T
  // Run detection: count runs of same parity
  let runs=1, maxRun=1, curRun=1;
  for(let i=1;i<32;i++){
    const parCur=parseInt(md5[i],16)%2;
    const parPrv=parseInt(md5[i-1],16)%2;
    if(parCur===parPrv){curRun++;maxRun=Math.max(maxRun,curRun);}
    else{runs++;curRun=1;}
  }
  const runBias=(maxRun>4)?0.06:0; // long runs add slight bias to prevalent parity
  const l3Score=0.5+letterBias*0.3+runBias;

  // â”€ Composite â”€
  const rawPT = l1Score*0.55 + l2Score*0.30 + l3Score*0.15;
  // Sigmoid sharpening to push toward extremes slightly
  const sigmoid = x => 1/(1+Math.exp(-8*(x-0.5)));
  const pT = 0.4*rawPT + 0.6*sigmoid(rawPT);
  const pT_clamp = Math.min(0.97,Math.max(0.03,pT));
  const pX_clamp = 1-pT_clamp;
  const isTai = pT_clamp>=0.5;

  // â”€ Confidence â”€
  const deviation=Math.abs(pT_clamp-0.5); // 0..0.47
  const entropyBoost=normVar*8;
  const rawConf=50+deviation*88+entropyBoost;
  const conf=Math.min(96.5,Math.max(51,rawConf));

  // â”€ Bias score â”€
  const biasScore=((Math.abs(meanBias)+Math.abs(xorBias))/2*100).toFixed(1);

  return {
    segs, bytes, mean, normVar,
    pT: pT_clamp, pX: pX_clamp,
    isTai, conf,
    l1Score, l2Score, l3Score,
    meanBias, xorBias, letterBias,
    biasScore, maxRun,
    letters, digits
  };
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// RENDER
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderResult(md5, R){
  const isTai=R.isTai;

  // Verdict panel class
  const vp=document.getElementById('verdictPanel');
  vp.className='verdict-panel '+(isTai?'tai':'xiu');

  // Label
  document.getElementById('verdictLabel').textContent=isTai?'TÃ€I':'Xá»ˆU';
  document.getElementById('verdictType').textContent=
    isTai?'Tá»•ng: VÃ¹ng cao (11â€“18)':'Tá»•ng: VÃ¹ng tháº¥p (3â€“10)';

  // Confidence
  const confPct=R.conf;
  document.getElementById('confPct').textContent=confPct.toFixed(1)+'%';
  setTimeout(()=>{document.getElementById('confFill').style.width=confPct+'%';},100);

  // Warning badge
  const wb=document.getElementById('warnBadge');
  const wi=document.getElementById('warnIcon');
  const wt=document.getElementById('warnTxt');
  if(confPct>=85){
    wb.className='warn-badge strong';
    wi.textContent='ğŸŸ¢';
    wt.innerHTML=`<b>VÃ€O Máº NH â€” TÃN HIá»†U Ráº¤T CAO</b><br>Há»‡ thá»‘ng phÃ¡t hiá»‡n tÃ­n hiá»‡u ${isTai?'TÃ i':'Xá»‰u'} cá»±c máº¡nh (${confPct.toFixed(1)}%). PhÃ¢n tÃ­ch Ä‘a lá»›p Ä‘á»“ng thuáº­n cao. Khuyáº¿n nghá»‹: Ä‘áº·t cÆ°á»£c vá»›i lá»±c lá»›n.`;
  } else if(confPct>=72){
    wb.className='warn-badge light';
    wi.textContent='ğŸŸ¡';
    wt.innerHTML=`<b>VÃ€O NHáº¸ â€” TÃN HIá»†U KHÃ</b><br>Há»‡ thá»‘ng phÃ¡t hiá»‡n tÃ­n hiá»‡u ${isTai?'TÃ i':'Xá»‰u'} á»Ÿ má»©c khÃ¡ (${confPct.toFixed(1)}%). Má»™t sá»‘ lá»›p phÃ¢n tÃ­ch cÃ³ sai lá»‡ch nhá». Khuyáº¿n nghá»‹: Ä‘áº·t cÆ°á»£c thá»­ vá»›i lá»±c vá»«a pháº£i.`;
  } else {
    wb.className='warn-badge caution';
    wi.textContent='ğŸŸ ';
    wt.innerHTML=`<b>THáº¬N TRá»ŒNG â€” TÃN HIá»†U Yáº¾U</b><br>TÃ­n hiá»‡u ${isTai?'TÃ i':'Xá»‰u'} khÃ´ng rÃµ rÃ ng (${confPct.toFixed(1)}%). CÃ¡c lá»›p phÃ¢n tÃ­ch chÆ°a Ä‘á»“ng thuáº­n. Khuyáº¿n nghá»‹: bá» qua hoáº·c Ä‘áº·t cÆ°á»£c ráº¥t nhá».`;
  }

  // Stats
  document.getElementById('statTai').textContent=(R.pT*100).toFixed(1)+'%';
  document.getElementById('statXiu').textContent=(R.pX*100).toFixed(1)+'%';
  document.getElementById('statEntropy').textContent=(R.normVar*100).toFixed(0)+'pts';
  document.getElementById('statBias').textContent=R.biasScore;

  // Prob bar
  const pxW=(R.pX*100).toFixed(1);
  const ptW=(R.pT*100).toFixed(1);
  setTimeout(()=>{
    document.getElementById('probXiu').style.width=pxW+'%';
    document.getElementById('probTai').style.width=ptW+'%';
    document.getElementById('pctXiu').textContent=pxW+'%';
    document.getElementById('pctTai').textContent=ptW+'%';
  },120);

  // Hex grid
  const hg=document.getElementById('hexGrid');
  hg.innerHTML='';
  R.segs.forEach((s,i)=>{
    const isT=s.segVote>=0.5;
    const d=document.createElement('div');
    d.className='hex-seg '+(isT?'t':'x');
    d.innerHTML=`<div class="sv">${s.h}</div><div class="sv2">${s.d}</div><div class="si">${isT?'T':'X'}</div>`;
    d.style.animationDelay=(i*0.05)+'s';
    hg.appendChild(d);
  });

  // Byte map
  const bm=document.getElementById('byteMap');
  bm.innerHTML='';
  R.bytes.forEach(b=>{
    const heat=b/255;
    const cell=document.createElement('div');
    cell.className='byte-cell';
    const r=Math.round(heat*255);
    const g=Math.round((1-heat)*200);
    const bl=Math.round((1-Math.abs(heat-0.5)*2)*150);
    cell.style.background=`rgb(${r},${g},${bl})`;
    cell.textContent=b.toString(16).padStart(2,'0');
    bm.appendChild(cell);
  });

  // Log
  const log=document.getElementById('logWrap');
  const tNow=()=>new Date().toLocaleTimeString('vi',{hour12:false});
  const lines=[
    {t:tNow(), m:`Khá»Ÿi Ä‘á»™ng phÃ¢n tÃ­ch MD5: <b>${md5.slice(0,8)}...${md5.slice(-4)}</b>`},
    {t:tNow(), m:`[L1] Segment voting: ${R.segs.filter(s=>s.segVote>=0.5).length}/8 Ä‘oáº¡n â†’ <span class="${isTai?'hi-t':'hi-x'}">${isTai?'TÃ i':'Xá»‰u'}</span>`},
    {t:tNow(), m:`[L1] Score lá»›p 1: <b>${(R.l1Score*100).toFixed(1)}%</b> (pT)`},
    {t:tNow(), m:`[L2] Byte mean: <b>${R.mean.toFixed(2)}/255</b> â€” Lean: <b>${R.meanBias>0?'+':''}${(R.meanBias*100).toFixed(1)}%</b>`},
    {t:tNow(), m:`[L2] XOR accumulator: <b>0x${R.xorAcc?.toString(16)||'--'}</b> â€” Entropy: <b>${(R.normVar*100).toFixed(0)}pts</b>`},
    {t:tNow(), m:`[L2] Score lá»›p 2: <b>${(R.l2Score*100).toFixed(1)}%</b>`},
    {t:tNow(), m:`[L3] KÃ½ tá»± hex a-f: <b>${R.letters}</b> Â· 0-9: <b>${R.digits}</b> â€” Letter bias: <b>${(R.letterBias*100).toFixed(1)}%</b>`},
    {t:tNow(), m:`[L3] Chuá»—i liÃªn tiáº¿p tá»‘i Ä‘a: <b>${R.maxRun}</b> nibble Â· Score: <b>${(R.l3Score*100).toFixed(1)}%</b>`},
    {t:tNow(), m:`[COMPOSITE] pT(raw): <b>${(R.pT*100).toFixed(2)}%</b> Â· pX: <b>${(R.pX*100).toFixed(2)}%</b>`},
    {t:tNow(), m:`[RESULT] <span class="hi-g">â¬¡ ${isTai?'TÃ€I':'Xá»ˆU'} â€” Äá»™ tin cáº­y: ${R.conf.toFixed(1)}%</span>`},
  ];
  log.innerHTML=lines.map(l=>`<div class="log-line"><span class="log-time">[${l.t}]</span><span class="log-msg">&nbsp;${l.m}</span></div>`).join('');
  log.scrollTop=log.scrollHeight;

  // Show result
  const ra=document.getElementById('resultArea');
  ra.className='result-area';
  void ra.offsetWidth;
  ra.className='result-area show';
  setTimeout(()=>ra.scrollIntoView({behavior:'smooth',block:'start'}),100);
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// ANALYZE (with animation)
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const ANA_STEPS=[
  'DECODING HEX SEGMENTS...',
  'RUNNING SEGMENT VOTING LAYER...',
  'COMPUTING BYTE ENTROPY...',
  'ANALYZING PATTERN DISTRIBUTION...',
  'CALCULATING COMPOSITE SCORE...',
  'APPLYING SIGMOID NORMALIZATION...',
  'GENERATING PREDICTION...',
  'FINALIZING REPORT...',
];

let analyzing=false;
function analyze(){
  if(analyzing)return;
  const md5=document.getElementById('md5In').value.trim().toLowerCase();
  if(!hexRe.test(md5))return;
  analyzing=true;

  const btn=document.getElementById('btnAnalyze');
  btn.disabled=true;
  document.getElementById('resultArea').className='result-area';

  const anaDiv=document.getElementById('analyzingDiv');
  const anaBar=document.getElementById('anaBar');
  const anaTxt=document.getElementById('anaTxt');
  const anaSteps=document.getElementById('anaSteps');
  anaDiv.className='analyzing show';
  anaBar.style.width='0%';

  let step=0;
  const total=ANA_STEPS.length;
  const stepDur=200;

  const tick=()=>{
    if(step>=total){
      setTimeout(()=>{
        anaDiv.className='analyzing';
        const R=analyzeMD5(md5);
        renderResult(md5,R);
        btn.disabled=false;
        analyzing=false;
      },300);
      return;
    }
    anaTxt.textContent=ANA_STEPS[step];
    anaSteps.textContent=`>_ ${(step+1)}/${total} MODULES PROCESSED`;
    anaBar.style.width=((step+1)/total*100)+'%';
    step++;
    setTimeout(tick,stepDur);
  };
  tick();
}

// allow Enter key
document.getElementById('md5In').addEventListener('keydown',e=>{
  if(e.key==='Enter')analyze();
});
</script>
</body>
</html>
